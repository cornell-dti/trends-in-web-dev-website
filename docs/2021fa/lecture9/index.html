<!doctype html>
<html class="docs-version-2021fa" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.7">
<title data-react-helmet="true">Lecture 9 | Trends in Web Dev</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://webdev.cornelldti.org/docs/2021fa/lecture9"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="2021fa"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-2021fa"><meta data-react-helmet="true" property="og:title" content="Lecture 9 | Trends in Web Dev"><meta data-react-helmet="true" name="description" content="Lecture Slides"><meta data-react-helmet="true" property="og:description" content="Lecture Slides"><link data-react-helmet="true" rel="shortcut icon" href="/img/logo.png"><link data-react-helmet="true" rel="canonical" href="https://webdev.cornelldti.org/docs/2021fa/lecture9"><link data-react-helmet="true" rel="alternate" href="https://webdev.cornelldti.org/docs/2021fa/lecture9" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://webdev.cornelldti.org/docs/2021fa/lecture9" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.53ee0a34.css">
<link rel="preload" href="/assets/js/runtime~main.c7857b94.js" as="script">
<link rel="preload" href="/assets/js/main.8f5748b9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Cornell DTI Web Development Course Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.png" alt="Cornell DTI Web Development Course Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Trends in Web Dev</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/docs/2021fa/introduction">2021fa</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/introduction">2024sp</a></li><li><a class="dropdown__link" href="/docs/2023fa/lecture9">2023fa</a></li><li><a class="dropdown__link" href="/docs/2023sp/lecture9">2023sp</a></li><li><a class="dropdown__link" href="/docs/2022fa/lecture9">2022fa</a></li><li><a class="dropdown__link" href="/docs/2022sp/lecture9">2022sp</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/2021fa/lecture9">2021fa</a></li><li><a class="dropdown__link" href="/docs/2021sp/lecture9">2021sp</a></li><li><a class="dropdown__link" href="/docs/2020fa/lecture9">2020fa</a></li><li><a class="dropdown__link" href="/docs/2020sp/lecture9">2020sp</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/introduction">Getting Started</a><a class="navbar__item navbar__link" href="/docs/lecture1">Lectures</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/cornell-dti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Getting Started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Lectures</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2021fa/lecture1">Lecture 1</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2021fa/lecture2">Lecture 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2021fa/lecture3">Lecture 3</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2021fa/lecture4">Lecture 4</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2021fa/lecture5">Lecture 5</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2021fa/lecture6">Lecture 6</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2021fa/lecture7">Lecture 7</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2021fa/lecture8">Lecture 8</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/2021fa/lecture9">Lecture 9</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/2021fa/lecture10">Lecture 10</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Assignments</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Trends in Web Dev<!-- --> <b>2021fa</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/introduction">latest version</a></b> (<!-- -->2024sp<!-- -->).</div></div><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->2021fa</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Lecture 9</h1></header><p><a href="https://docs.google.com/presentation/d/1khV0GSLhAAsbrWrQQ5PxH3R6cCNNllY0rOGeN1g9rpM/edit?usp=sharing" target="_blank" rel="noopener noreferrer">Lecture Slides</a></p><p><a href="https://github.com/Enochen/trends-fa21-lec9-demo/" target="_blank" rel="noopener noreferrer">Lecture Demo Source Code</a></p><p><a href="/docs/2021fa/finalproject">Final Project Instructions</a></p><p><a href="/docs/2021fa/finalproject#milestone-1">Final Project - Milestone 1</a> due <strong>11/21 by 11:59pm</strong></p><p><a href="/docs/2021fa/finalproject#milestone-2">Final Project - Milestone 2</a> due <strong>12/2 by 11:59pm</strong></p><p><a href="/docs/2021fa/finalproject#milestone-3">Final Project - Milestone 3</a> due <strong>12/9 by 11:59pm</strong></p><p>Vote for the Lecture 10 topic <a href="https://bit.ly/trends-choice" target="_blank" rel="noopener noreferrer">here</a> by <strong>11/24 11:59pm</strong></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="yarn-workspaces">Yarn Workspaces<a aria-hidden="true" class="hash-link" href="#yarn-workspaces" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="replacing-our-familiar-workflow">Replacing our familiar workflow<a aria-hidden="true" class="hash-link" href="#replacing-our-familiar-workflow" title="Direct link to heading">​</a></h3><p>Normally, to run both the backend and frontend, we have to do something like this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token builtin class-name" style="color:rgb(193, 132, 1)">cd</span><span class="token plain"> backend</span><br></span><span class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(64, 120, 242)">yarn</span><span class="token plain"> </span><span class="token function" style="color:rgb(64, 120, 242)">install</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(64, 120, 242)">yarn</span><span class="token plain"> start  </span><span class="token comment" style="color:rgb(160, 161, 167);font-style:italic"># start the backend</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(193, 132, 1)">cd</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">..</span><span class="token plain">/frontend</span><br></span><span class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(64, 120, 242)">yarn</span><span class="token plain"> </span><span class="token function" style="color:rgb(64, 120, 242)">install</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(64, 120, 242)">yarn</span><span class="token plain"> start  </span><span class="token comment" style="color:rgb(160, 161, 167);font-style:italic"># start the frontend</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We can make managing the frontend and backend easier by creating a package.json in our root directory and declaring a workspaces!</p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">package.json</div><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;private&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;workspaces&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">[</span><span class="token string" style="color:rgb(80, 161, 79)">&quot;frontend&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;backend&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">]</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="hoisting-package-manager-out-to-root">Hoisting package manager out to root<a aria-hidden="true" class="hash-link" href="#hoisting-package-manager-out-to-root" title="Direct link to heading">​</a></h3><p>One advantage of doing this is that dependencies are installed at the root, so if both your frontend and backend use the same version of TypeScript, it is only installed once at the workspace root.</p><p>Another thing you may notice is that only one lockfile is generated and it is placed at the workspace root with <code>package.json</code>.</p><p>Having your package manager at your root also makes running scripts from both workspaces much simpler. To run the respective <code>start</code> script for the frontend or backend, you can
run <code>yarn workspace frontend start</code> or <code>yarn workspace backend start</code></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="local-workspace-as-dependency">Local workspace as dependency<a aria-hidden="true" class="hash-link" href="#local-workspace-as-dependency" title="Direct link to heading">​</a></h3><p>If there is code that you wish to be shared between both your frontend and backend, for example, you can also declare that as another workspace in your <code>package.json</code>
and include it in the respective frontend and backend <code>package.json</code> like so:</p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">frontend/package.json</div><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;name&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;frontend&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;version&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;1.0.0&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;dependencies&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;typescript&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^4.1.2&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;react&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^17.0.0&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;helper-functions&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;1.0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="why-use-workspaces">Why use workspaces?<a aria-hidden="true" class="hash-link" href="#why-use-workspaces" title="Direct link to heading">​</a></h3><ul><li>Yarn workspaces allows your dependencies to be linked together, making it easier to manage a monorepo</li><li><code>yarn install</code> will generate one <code>yarn.lock</code> for the whole project, and having one lockfile creates fewer conflicts and makes code reviews easier<ul><li>Note: you should always commit and push <code>yarn.lock</code> and <code>package-lock.json</code></li></ul></li><li>Reduces redundancy in packages</li><li>Including workspaces as dependencies makes it easier to test your utility functions locally before you publish them online</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="yarn-workspaces-setup">Yarn workspaces setup<a aria-hidden="true" class="hash-link" href="#yarn-workspaces-setup" title="Direct link to heading">​</a></h3><p>We will be showing Yarn workspaces setup on our example Filterable Product Table App we&#x27;ve been working on throughout the semester. After lecture 8, we bridged the frontend and the backend together to fetch data from our API endpoints defined in <code>backend/index.ts</code> to show in the frontend UI.</p><p>We kept these two folders separate and we showed the old way of <code>cd</code> into each folder and running Yarn install. Now with workspaces we can manage the package from the root and directly run <code>yarn install</code> once to install all frontend and backend dependencies!</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="yarn-workspaces-setup-1">Yarn workspaces setup<a aria-hidden="true" class="hash-link" href="#yarn-workspaces-setup-1" title="Direct link to heading">​</a></h3><p>We will be showing Yarn workspaces setup on our example Filterable Product Table App we&#x27;ve been working on throughout the semester. After lecture 8, we bridged the frontend and the backend together to fetch data from our API endpoints defined in <code>backend/index.ts</code> to show in the frontend UI.</p><p>We kept these two folders separate and we showed the old way of <code>cd</code> into each folder and running Yarn install. Now with workspaces we can manage the package from the root and directly run <code>yarn install</code> once to install all frontend and backend dependencies!</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="root">Root<a aria-hidden="true" class="hash-link" href="#root" title="Direct link to heading">​</a></h4><p>To do this, our root <code>package.json</code> will define the workspaces. (Note: root means outside of both the frontend and backend folders, on that same level of the directory hierarchy.)</p><p>Most important lines here are 3-7 which define the workspaces and set <code>private: true</code> since <a href="https://classic.yarnpkg.com/en/docs/2021fa/workspaces/#toc-how-to-use-it" target="_blank" rel="noopener noreferrer">workspaces can&#x27;t be published</a>.</p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">/package.json</div><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;name&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;products-app&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;private&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;workspaces&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">[</span><span class="token string" style="color:rgb(80, 161, 79)">&quot;backend&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;frontend&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">]</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;version&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;1.0.0&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;main&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;index.js&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;license&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;MIT&quot;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="backend">Backend<a aria-hidden="true" class="hash-link" href="#backend" title="Direct link to heading">​</a></h4><p>Now our backend workspace will look like the following. I&#x27;ve omitted some of the dependencies part for brevity you can find the full file <a href="https://github.com/Enochen/trends-fa21-lec9-demo/blob/main/backend/package.json" target="_blank" rel="noopener noreferrer">here</a></p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">backend/package.json</div><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;name&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;backend&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;version&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;1.0.0&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;private&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;main&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;index.js&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;dependencies&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;cors&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^2.8.5&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;express&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^4.17.1&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;firebase-admin&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^10.0.0&quot;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token comment" style="color:rgb(160, 161, 167);font-style:italic">// dev dependencies...</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="frontend">Frontend<a aria-hidden="true" class="hash-link" href="#frontend" title="Direct link to heading">​</a></h4><p>Our frontend workspace will also look like the following. The full file can also be found <a href="https://github.com/Enochen/trends-fa21-lec9-demo/blob/main/frontend/package.json" target="_blank" rel="noopener noreferrer">here</a></p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">frontend/package.json</div><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;name&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;frontend&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;version&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;0.1.0&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;private&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;dependencies&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;@testing-library/jest-dom&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^5.11.4&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;@testing-library/react&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^11.1.0&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;@testing-library/user-event&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^12.1.10&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;@types/jest&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^26.0.15&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;@types/node&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^12.0.0&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;@types/react&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^17.0.0&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;@types/react-dom&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^17.0.0&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;axios&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^0.24.0&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;firebase&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^9.4.1&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;react&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^17.0.2&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;react-dom&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^17.0.2&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;react-firebaseui&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^6.0.0&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;react-scripts&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;4.0.3&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;typescript&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^4.1.2&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;web-vitals&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^1.0.1&quot;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;proxy&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;http://localhost:8080&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;scripts&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;start&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;react-scripts start&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;build&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;react-scripts build&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;test&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;react-scripts test&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;eject&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;react-scripts eject&quot;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token comment" style="color:rgb(160, 161, 167);font-style:italic">// other config and browser dependencies</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="profit">Profit!<a aria-hidden="true" class="hash-link" href="#profit" title="Direct link to heading">​</a></h4><p>Now we can profit from all our hardwork setting up by managing everything from the project root. In the root we can run:</p><p><code>yarn workspace frontend build</code> to build our frontend application. This is equivalent to running <code>react-scripts start</code> based on <code>frontend/package.json</code>.</p><p>We can also run <code>yarn workspace backend build</code> to build our backend application. This is equivalent to running <code>tsc -p tsconfig.json</code> based on <code>backend/package.json</code>.</p><p>In general the syntax for running a script for a workspace is <code>yarn workspace &lt;workspace_name&gt; &lt;script_name&gt;</code>. Where <code>&lt;workspace_name&gt;/package.json</code> has a value for <code>&lt;script_name&gt;</code> in the <code>scripts</code> section.</p><p>We notice we have two build scripts in backend and frontend. <code>yarn workspace run build</code> will tell yarn to run build script in all workspaces that have them.</p><p>Of course, we can also run <code>yarn install</code> in the project root to install all the dependencies required in all of our workspaces. If there are duplicates, yarn will only install the dependency once.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="learn-more">Learn more!<a aria-hidden="true" class="hash-link" href="#learn-more" title="Direct link to heading">​</a></h3><p>Yarn workspaces is super cool and we just covered a subset of functionality. If you want to learn more check out these links:</p><ul><li><a href="https://classic.yarnpkg.com/en/docs/2021fa/workspaces/#toc-how-to-use-it" target="_blank" rel="noopener noreferrer">How to use Yarn workspaces</a></li><li><a href="https://classic.yarnpkg.com/blog/2017/08/02/introducing-workspaces/" target="_blank" rel="noopener noreferrer">Blog post</a></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="authentication">Authentication<a aria-hidden="true" class="hash-link" href="#authentication" title="Direct link to heading">​</a></h2><p>One of the best parts about Firebase is you can use Sign in with Google/Facebook/GitHub/etc! This way you don&#x27;t have to deal with usernames and passwords yourself!</p><p>Before writing any code, you need to setup Firebase Authentication first.</p><p>In your project&#x27;s firebase console, click on the authentication icon below the settings icon:</p><p><img alt="authentication icon" src="/assets/images/authentication-icon-6219e823efacb6f2d39630fc21d027bb.png"></p><p>Then click on the sign-in method tab and enable Google login by following the setup instructions:</p><p><img alt="sign in method" src="/assets/images/signin-method-a02703a228bc864af687a9d2cd2090c9.png"></p><p>We did a Live Coding Demo here based on the Products example from last week. I will include the files changed here.</p><p>To handle authentication we made a wrapper component <code>Authenticated</code> to handle all Authentication:</p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">Authenticated.tsx</div><div class="codeBlockContent_csEI tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token imports punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token imports"> </span><span class="token imports punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token imports"> useState</span><span class="token imports punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token imports"> useEffect </span><span class="token imports punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;react&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;firebase/auth&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token imports"> initializeApp </span><span class="token imports punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;firebase/app&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token imports"></span><br></span><span class="token-line"><span class="token imports">  </span><span class="token imports maybe-class-name">User</span><span class="token imports punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token imports"></span><br></span><span class="token-line"><span class="token imports">  </span><span class="token imports maybe-class-name">GoogleAuthProvider</span><span class="token imports punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token imports"></span><br></span><span class="token-line"><span class="token imports">  onAuthStateChanged</span><span class="token imports punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token imports"></span><br></span><span class="token-line"><span class="token imports">  getAuth</span><span class="token imports punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token imports"></span><br></span><span class="token-line"><span class="token imports">  signOut</span><span class="token imports punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token imports"></span><br></span><span class="token-line"><span class="token imports"></span><span class="token imports punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;firebase/auth&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">FirebaseAuth</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;react-firebaseui/FirebaseAuth&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> firebaseConfig </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token comment" style="color:rgb(160, 161, 167);font-style:italic">// put firebase config in here.</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token comment" style="color:rgb(160, 161, 167);font-style:italic">// You can find the config in Project Settings &gt; General</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token comment" style="color:rgb(160, 161, 167);font-style:italic">// and choose the Config option in Firebase SDK snippet</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> firebase </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(64, 120, 242)">initializeApp</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">firebaseConfig</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> auth </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(64, 120, 242)">getAuth</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">firebase</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(193, 132, 1)">Props</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(166, 38, 164)">readonly</span><span class="token plain"> children</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token maybe-class-name">React</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token property-access maybe-class-name">ReactNode</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(64, 120, 242)">Authenticated</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"> children </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token maybe-class-name">Props</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(56, 58, 66)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">[</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> setUser</span><span class="token punctuation" style="color:rgb(56, 58, 66)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token generic-function function" style="color:rgb(64, 120, 242)">useState</span><span class="token generic-function generic class-name operator" style="color:rgb(56, 58, 66)">&lt;</span><span class="token generic-function generic class-name" style="color:rgb(193, 132, 1)">User </span><span class="token generic-function generic class-name operator" style="color:rgb(56, 58, 66)">|</span><span class="token generic-function generic class-name" style="color:rgb(193, 132, 1)"> </span><span class="token generic-function generic class-name keyword" style="color:rgb(166, 38, 164)">null</span><span class="token generic-function generic class-name operator" style="color:rgb(56, 58, 66)">&gt;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token keyword" style="color:rgb(166, 38, 164)">null</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> uiConfig </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    signInFlow</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;popup&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    signInOptions</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">[</span><span class="token maybe-class-name">GoogleAuthProvider</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token constant" style="color:rgb(152, 104, 1)">PROVIDER_ID</span><span class="token punctuation" style="color:rgb(56, 58, 66)">]</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token function" style="color:rgb(64, 120, 242)">useEffect</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:rgb(56, 58, 66)">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(64, 120, 242)">onAuthStateChanged</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">auth</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> setUser</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">[</span><span class="token punctuation" style="color:rgb(56, 58, 66)">]</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(166, 38, 164)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line"><span class="token plain-text">      </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain">user </span><span class="token operator" style="color:rgb(56, 58, 66)">?</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line"><span class="token plain-text">          </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;</span><span class="token tag" style="color:rgb(228, 86, 73)">h2</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&gt;</span><span class="token plain-text">Hi, </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain">user</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token property-access">displayName</span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain-text">!</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;/</span><span class="token tag" style="color:rgb(228, 86, 73)">h2</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line"><span class="token plain-text">          </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;</span><span class="token tag" style="color:rgb(228, 86, 73)">button</span><span class="token tag" style="color:rgb(228, 86, 73)"> </span><span class="token tag attr-name" style="color:rgb(152, 104, 1)">onClick</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(56, 58, 66)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token tag script language-javascript punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token tag script language-javascript punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token tag script language-javascript" style="color:rgb(228, 86, 73)"> </span><span class="token tag script language-javascript arrow operator" style="color:rgb(56, 58, 66)">=&gt;</span><span class="token tag script language-javascript" style="color:rgb(228, 86, 73)"> </span><span class="token tag script language-javascript function" style="color:rgb(64, 120, 242)">signOut</span><span class="token tag script language-javascript punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token tag script language-javascript" style="color:rgb(228, 86, 73)">auth</span><span class="token tag script language-javascript punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token tag script language-javascript punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&gt;</span><span class="token plain-text">Sign Out</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;/</span><span class="token tag" style="color:rgb(228, 86, 73)">button</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line"><span class="token plain-text">          </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain">children</span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain-text"></span><br></span><span class="token-line"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;/</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&gt;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">        </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;</span><span class="token tag class-name" style="color:rgb(193, 132, 1)">FirebaseAuth</span><span class="token tag" style="color:rgb(228, 86, 73)"> </span><span class="token tag attr-name" style="color:rgb(152, 104, 1)">uiConfig</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(56, 58, 66)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token tag script language-javascript" style="color:rgb(228, 86, 73)">uiConfig</span><span class="token tag script language-javascript punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token tag" style="color:rgb(228, 86, 73)"> </span><span class="token tag attr-name" style="color:rgb(152, 104, 1)">firebaseAuth</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:rgb(56, 58, 66)">=</span><span class="token tag script language-javascript punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token tag script language-javascript" style="color:rgb(228, 86, 73)">auth</span><span class="token tag script language-javascript punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token tag" style="color:rgb(228, 86, 73)"> </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">/&gt;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain-text"></span><br></span><span class="token-line"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;/</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&gt;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">default</span><span class="token plain"> </span><span class="token maybe-class-name">Authenticated</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We then wrap our whole <code>FilterableProductTable</code> app in <code>Authenticated</code>.</p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">App.tsx</div><div class="codeBlockContent_csEI tsx"><pre tabindex="0" class="prism-code language-tsx codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;./App.css&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">Authenticated</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;./Authenticated&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">FilterableProductTable</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;./FilterableProductTable&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">function</span><span class="token plain"> </span><span class="token function" style="color:rgb(64, 120, 242)">App</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(166, 38, 164)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;</span><span class="token tag" style="color:rgb(228, 86, 73)">div</span><span class="token tag" style="color:rgb(228, 86, 73)"> </span><span class="token tag attr-name" style="color:rgb(152, 104, 1)">className</span><span class="token tag attr-value punctuation attr-equals" style="color:rgb(56, 58, 66)">=</span><span class="token tag attr-value punctuation" style="color:rgb(56, 58, 66)">&quot;</span><span class="token tag attr-value" style="color:rgb(228, 86, 73)">App</span><span class="token tag attr-value punctuation" style="color:rgb(56, 58, 66)">&quot;</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;</span><span class="token tag class-name" style="color:rgb(193, 132, 1)">Authenticated</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line"><span class="token plain-text">        </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;</span><span class="token tag class-name" style="color:rgb(193, 132, 1)">FilterableProductTable</span><span class="token tag" style="color:rgb(228, 86, 73)"> </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">/&gt;</span><span class="token plain-text"></span><br></span><span class="token-line"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;/</span><span class="token tag class-name" style="color:rgb(193, 132, 1)">Authenticated</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&lt;/</span><span class="token tag" style="color:rgb(228, 86, 73)">div</span><span class="token tag punctuation" style="color:rgb(56, 58, 66)">&gt;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">export</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">default</span><span class="token plain"> </span><span class="token maybe-class-name">App</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If the user is logged in, <code>FilterableProductTable</code> will show. Otherwise they will be asked to log in.</p><p>We then deployed this app on Firebase for the frontend and Heroku for the backend. Refer to the commands above.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>We recommend using Firebase&#x27;s built-in support for Google Authentication since storing passwords securely is <em>very hard</em> (more details in the security section). Firebase also has support for many other accounts such as Facebook, GitHub, Microsoft, Apple, etc. Read more about Firebase Authentication <a href="https://firebase.google.com/docs/2021fa/auth/web/firebaseui" target="_blank" rel="noopener noreferrer">here</a>. If for whatever reason you really want to implement your own user accounts, Firebase can still help you store passwords securely. Read more <a href="https://firebase.google.com/docs/2021fa/auth/web/password-auth" target="_blank" rel="noopener noreferrer">here</a>.</p></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="security">Security<a aria-hidden="true" class="hash-link" href="#security" title="Direct link to heading">​</a></h2><p>Web app security is integral in a world where people have malicious intentions. As such, we advocate for at least these basic security measures.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="1-passwords">1. Passwords<a aria-hidden="true" class="hash-link" href="#1-passwords" title="Direct link to heading">​</a></h3><p>Do NOT store passwords in plain text in your database!!</p><p>If somehow there were a vulnerability in your database, the passwords of all of your users would be directly exposed to hackers.
Moreover, many people reuse their passwords for some if not all other, so you could also compromise something like someone&#x27;s banking credentials or emails.</p><p>While it is safer to store hashed passwords, it is very easy to do it incorrectly, which is why we teach firebase authentication!</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="2-input-sanitization">2. Input Sanitization<a aria-hidden="true" class="hash-link" href="#2-input-sanitization" title="Direct link to heading">​</a></h3><p>Input sanitization &#x27;cleanses&#x27; inputs so that they can not be used in unintended ways.</p><p>For example, it may seem reasonable to add every comment on a blog into a database entry like this:
<code>“INSERT INTO &#x27;comments&#x27; (comment) VALUES &#x27;” + user_input + “&#x27;;”</code>, but it is actually incredibly unsafe
if <code>user_input</code> were something like <code>&#x27;; DROP TABLE comments;</code>.</p><p>Luckily for us, <a href="https://reactjs.org/docs/2021fa/introducing-jsx.html#jsx-prevents-injection-attacks" target="_blank" rel="noopener noreferrer">React DOM escapes values embedded in JSX before rendering them by default, preventing injection attacks</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="3-dont-rely-on-client-side-verification">3. Don&#x27;t Rely on Client Side Verification<a aria-hidden="true" class="hash-link" href="#3-dont-rely-on-client-side-verification" title="Direct link to heading">​</a></h3><p>In general you cannot assume your endpoint will only be used by your frontend.</p><p>Recall that we used Postman at the beginning of the semester to test Express endpoints. As such, it is always important to verify your inputs and authenticate your requests!</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="4-separation-of-privileges">4. Separation of Privileges<a aria-hidden="true" class="hash-link" href="#4-separation-of-privileges" title="Direct link to heading">​</a></h3><p>Going hand-in-hand with the last point, when a request is made to your backend, make sure that the source of your request has the sufficient permissions to perform whatever action is being asked!</p><p>For example, if the OfficeHours app recieved a request to edit the times to someone&#x27;s office hours, the backend would check that this person is indeed the TA who owns that OH and not a student.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="lets-hack-our-app">Let&#x27;s hack our app!<a aria-hidden="true" class="hash-link" href="#lets-hack-our-app" title="Direct link to heading">​</a></h3><p>In the lecture we didn&#x27;t have time to show you guys how we could hack our application. However, if you are interested you can do so by sending in bad unauthenticated input data.</p><p>We fixed the backend by using Firebase Admin&#x27;s verifyIdToken function to check whether the user had logged in or not.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="backend-1">Backend<a aria-hidden="true" class="hash-link" href="#backend-1" title="Direct link to heading">​</a></h4><p>On the backend, we had the <code>post</code> endpoints check the <code>idtoken</code> in the request headers <code>authorization</code>.</p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">backend/index.ts</div><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">post</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;/createProduct&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">req</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> idToken </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token plain">headers</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token plain">authorization </span><span class="token operator" style="color:rgb(56, 58, 66)">||</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(166, 38, 164)">try</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token keyword" style="color:rgb(166, 38, 164)">await</span><span class="token plain"> auth</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">verifyIdToken</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">idToken</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> newProduct </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> req</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token plain">body </span><span class="token keyword" style="color:rgb(166, 38, 164)">as</span><span class="token plain"> Product</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> addedProduct </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">await</span><span class="token plain"> productsCollection</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">add</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">newProduct</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    res</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">send</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">addedProduct</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token plain">id</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">catch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">error</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    res</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">send</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;auth error&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We call <code>await auth.verifyIdToken(idToken)</code> and only then do we allow the input to be saved. Otherwise, we log the error.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="frontend-1">Frontend<a aria-hidden="true" class="hash-link" href="#frontend-1" title="Direct link to heading">​</a></h4><p>Now when we send the request back, we need to send the idtoken with the request header. So in the <code>createProduct</code> method that called the POST endpoints above, we send call <code>getAuth().currentUser?.getIdToken()</code> to get the user&#x27;s idtoken. Then we pass it in as a field to <code>headers</code> in the fetch. However, if the currentUser is undefined for some reason (what the <code>?</code> catches). Everything else should be familiar from last lecture.</p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">frontend/src/FilterableProductTable.tsx</div><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:rgb(64, 120, 242)">createProduct</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> newProduct </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"> name</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> price</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> stocked </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(166, 38, 164)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token operator" style="color:rgb(56, 58, 66)">!</span><span class="token plain">name </span><span class="token operator" style="color:rgb(56, 58, 66)">||</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">!</span><span class="token plain">price</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token function" style="color:rgb(64, 120, 242)">alert</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;Fields cannot be empty&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token keyword" style="color:rgb(166, 38, 164)">return</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token function" style="color:rgb(64, 120, 242)">getAuth</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token plain">currentUser</span><span class="token operator" style="color:rgb(56, 58, 66)">?.</span><span class="token function" style="color:rgb(64, 120, 242)">getIdToken</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">then</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">idToken</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">=&gt;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">      </span><span class="token function" style="color:rgb(64, 120, 242)">fetch</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;/createProduct&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">        method</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;POST&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">        headers</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">          </span><span class="token string-property property" style="color:rgb(152, 104, 1)">&#x27;content-type&#x27;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;application/json&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">          authorization</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> idToken</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">        body</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token constant" style="color:rgb(152, 104, 1)">JSON</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">stringify</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">newProduct</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">then</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">res</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">=&gt;</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">text</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">then</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">      </span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> newProductWithID </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">...</span><span class="token plain">newProduct</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> id</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> data </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">      </span><span class="token function" style="color:rgb(64, 120, 242)">setProducts</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">[</span><span class="token operator" style="color:rgb(56, 58, 66)">...</span><span class="token plain">products</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> newProductWithID</span><span class="token punctuation" style="color:rgb(56, 58, 66)">]</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="security-best-practices">Security Best Practices<a aria-hidden="true" class="hash-link" href="#security-best-practices" title="Direct link to heading">​</a></h4><p>There is a lot more we could&#x27;ve done in terms of security here.</p><ol><li>We should send back error messages to the user about why requests are failing instead of just doing <code>console.log()</code> since the user won&#x27;t see that. This would be bad user experience since they don&#x27;t have feedback about why things aren&#x27;t working.</li><li>We should also do input validation on the backend to ensure we are getting our expected inputs. What if we aren&#x27;t passing an object that looks like:</li></ol><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token string-property property" style="color:rgb(152, 104, 1)">&quot;category&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(152, 104, 1)">string</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token string-property property" style="color:rgb(152, 104, 1)">&quot;price&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(152, 104, 1)">string</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token string-property property" style="color:rgb(152, 104, 1)">&quot;stocked&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(152, 104, 1)">boolean</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token string-property property" style="color:rgb(152, 104, 1)">&quot;name&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(152, 104, 1)">string</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="deployment">Deployment<a aria-hidden="true" class="hash-link" href="#deployment" title="Direct link to heading">​</a></h2><p>To deploy your web application means to put it on a web server so others can access it via the internet. We will deploy both our frontend and backend on Heroku. There are a variety of services you can use for deployment including Firebase, Amazon AWS, Microsoft Azure, etc, but we decided to show you Heroku deployment since it is easier and requires less setup.</p><p>We will be taking our filterable product table app we have been building throughout the course and deploying it to a remote server. To deploy your own app (for final project for example), you can follow the same steps usually.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="deployment-setup">Deployment Setup<a aria-hidden="true" class="hash-link" href="#deployment-setup" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_y2LR" id="backend-2">Backend<a aria-hidden="true" class="hash-link" href="#backend-2" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_y2LR" id="indexts"><code>index.ts</code><a aria-hidden="true" class="hash-link" href="#indexts" title="Direct link to heading">​</a></h5><p>To deploy to Heroku we need some additional setup. In the frontend folder, when you run <code>yarn build</code>, you will get a <code>build</code> directory containing all the optimized, bundled frontend React code ready to be pushed to a remote server. We will include the line <code>app.use(express.static(path.join(__dirname, &#x27;../frontend/build&#x27;)));</code> to do this. (Note: this requires us to <code>import path from &#x27;path&#x27;;</code>)</p><p>We will also be calling upon our express app to use CORS to allow cross origin requests. If your backend requests are being blocked be of some <code>CORS cross origin policy</code> issue you probably forgot to include the <code>app.use(cors());</code> line. (Note: this requires us to <code>import cors from &#x27;cors&#x27;;</code>)</p><p>The beginning of your <code>backend/index.ts</code> should look like the below. Note the CORS line (line 7) and express static serving line (line 8) we described above and the relevant import statements.</p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">backend/index.ts</div><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> express </span><span class="token keyword" style="color:rgb(166, 38, 164)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;express&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> cors </span><span class="token keyword" style="color:rgb(166, 38, 164)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;cors&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> path </span><span class="token keyword" style="color:rgb(166, 38, 164)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;path&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> auth </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;./firebase-config&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> app </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(64, 120, 242)">express</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">use</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token function" style="color:rgb(64, 120, 242)">cors</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">use</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">express</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">static</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">join</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">__dirname</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;../../frontend/build&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">use</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">express</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">json</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> port </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token plain">env</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token constant" style="color:rgb(152, 104, 1)">PORT</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">||</span><span class="token plain"> </span><span class="token number" style="color:rgb(152, 104, 1)">8080</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(193, 132, 1)">Product</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  price</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(152, 104, 1)">string</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  stocked</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(152, 104, 1)">boolean</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  name</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(152, 104, 1)">string</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">type</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(193, 132, 1)">ProductWithID</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> Product </span><span class="token operator" style="color:rgb(56, 58, 66)">&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  id</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(152, 104, 1)">string</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> productsCollection </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">collection</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;products&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">get</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;/getProducts&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">async</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">_</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> res</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> products </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">await</span><span class="token plain"> productsCollection</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">get</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  res</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">json</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    products</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token plain">docs</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">map</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">doc</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> ProductWithID </span><span class="token operator" style="color:rgb(56, 58, 66)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">      </span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> product </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> doc</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">data</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">as</span><span class="token plain"> Product</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">      </span><span class="token keyword" style="color:rgb(166, 38, 164)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">...</span><span class="token plain">product</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> id</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> doc</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token plain">id </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token comment" style="color:rgb(160, 161, 167);font-style:italic">// other routes...</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">app</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">listen</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">port</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">=&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(152, 104, 1)">console</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">log</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token template-string template-punctuation string" style="color:rgb(80, 161, 79)">`</span><span class="token template-string string" style="color:rgb(80, 161, 79)">Example app listening on port </span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(56, 58, 66)">${</span><span class="token template-string interpolation">port</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token template-string string" style="color:rgb(80, 161, 79)">!</span><span class="token template-string template-punctuation string" style="color:rgb(80, 161, 79)">`</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Notice we are having <code>app.listen</code> listen for either <code>process.env.PORT</code> or port 8080. Previously, we hardcoded <code>8080</code> for this parameter. <code>process.env.PORT</code> will be defined by Heroku and we want the app to listen for requests on that port in the deployed site.</p></div></div><p>We can load the <code>FIREBASE_PRIVATE_KEY</code> from the environment variable instead of having it in plaintext inside the <code>firebase-adminsdk.json</code> file. This is the service account JSON we were working with with Firebase! By removing the private key from our file, we can publish this code on a public repository without exposing our private key.</p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">firebase-adminsdk.json</div><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token string-property property" style="color:rgb(152, 104, 1)">&quot;type&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;service_account&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token comment" style="color:rgb(160, 161, 167);font-style:italic">// ...stuff</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token string-property property" style="color:rgb(152, 104, 1)">&quot;private_key&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token comment" style="color:rgb(160, 161, 167);font-style:italic">// ...more stuff</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To run our app <strong>locally</strong> we create a .env file inside the frontend folder that contains the actual value for the private key.</p><p>Make sure that the <code>.env</code> file is inside the <code>backend</code> folder!</p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">.env</div><div class="codeBlockContent_csEI env"><pre tabindex="0" class="prism-code language-env codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">FIREBASE_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>However, our <code>.env</code> file does not get included with the repository, since it has sensitive information.</p><p>In <strong>Heroku</strong> there is a section called &quot;Config Vars&quot; in the settings which you can use to set the environment variables for deployment.</p><p><img alt="Heroku Config Vars" src="/assets/images/heroku-config-a0ec9aef03b4adcc8f4e060a54136786.png"></p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p><strong>How do we stop the <code>.env</code> file from being included with the repository?</strong></p><p>Sometimes we don&#x27;t want a local file to be part of the repository. Each version
control system has its own way of excluding files. We are using <code>git</code>, which
uses the <code>.gitignore</code> file. You will most often see a <code>.gitignore</code> file in the
top-level directory of a repository, but they can exist in any child directory
as well.</p><p>To specify what to ignore, we add lines to a <code>.gitingore</code> file containing a
pattern (similar to globs). When a file or folder name matches a pattern inside
the <code>.gitignore</code> file, it gets excluded from the repository.</p><p>For example, we would add a line containing <code>.env</code> to ignore all files (and
folders) named <code>.env</code>. Of course, you could do a lot more complex stuff with the
patterns you have at your disposal!</p><p>Learn more about the <code>.gitignore</code> file <a href="https://git-scm.com/docs/2021fa/gitignore" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Find the <code>.gitignore</code> file for the lecture demo <a href="https://github.com/Enochen/trends-fa21-lec9-demo/blob/main/.gitignore" target="_blank" rel="noopener noreferrer">here</a>.</p></div></div><p>Feel free to use the following code as-is to load the private key from the environment.</p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">backend/firebase-config.ts</div><div class="codeBlockContent_csEI ts"><pre tabindex="0" class="prism-code language-ts codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">*</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">as</span><span class="token plain"> admin </span><span class="token keyword" style="color:rgb(166, 38, 164)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;firebase-admin&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"> readFileSync </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;fs&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">import</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"> config </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(166, 38, 164)">from</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;dotenv&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(64, 120, 242)">config</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> serviceAccountPath </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;./firebase-adminsdk.json&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> hydrateServiceAccount </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  serviceAccountPath</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(152, 104, 1)">string</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> admin</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token plain">ServiceAccount </span><span class="token operator" style="color:rgb(56, 58, 66)">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> serviceAccount </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> </span><span class="token constant" style="color:rgb(152, 104, 1)">JSON</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">parse</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token function" style="color:rgb(64, 120, 242)">readFileSync</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">serviceAccountPath</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">toString</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> privateKey </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> process</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token plain">env</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token constant" style="color:rgb(152, 104, 1)">FIREBASE_PRIVATE_KEY</span><span class="token operator" style="color:rgb(56, 58, 66)">?.</span><span class="token function" style="color:rgb(64, 120, 242)">replace</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-source language-regex">\\n</span><span class="token regex regex-delimiter">/</span><span class="token regex regex-flags">g</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&#x27;\n&#x27;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token keyword" style="color:rgb(166, 38, 164)">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"> </span><span class="token operator" style="color:rgb(56, 58, 66)">...</span><span class="token plain">serviceAccount</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> privateKey </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain">admin</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">initializeApp</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  credential</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> admin</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token plain">credential</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">cert</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token function" style="color:rgb(64, 120, 242)">hydrateServiceAccount</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">serviceAccountPath</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> db </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> admin</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">firestore</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">const</span><span class="token plain"> auth </span><span class="token operator" style="color:rgb(56, 58, 66)">=</span><span class="token plain"> admin</span><span class="token punctuation" style="color:rgb(56, 58, 66)">.</span><span class="token function" style="color:rgb(64, 120, 242)">auth</span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token keyword" style="color:rgb(166, 38, 164)">export</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> auth </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p><code>firebase-config.ts</code> contains the <code>hydrateServiceAccount</code> function which reads the value from the environment variable, loads up the rest of the <code>firebase-adminsdk json</code>, and combines them together to get a full service account object which you can initialize the Firebase admin with.</p></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="frontend-2">Frontend<a aria-hidden="true" class="hash-link" href="#frontend-2" title="Direct link to heading">​</a></h4><p>No further setup required in our frontend folder.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="root-1">Root<a aria-hidden="true" class="hash-link" href="#root-1" title="Direct link to heading">​</a></h4><h5 class="anchor anchorWithStickyNavbar_y2LR" id="packagejson"><code>package.json</code><a aria-hidden="true" class="hash-link" href="#packagejson" title="Direct link to heading">​</a></h5><p>Our root <code>package.json</code> will look like the following. We are using yarn workspaces as described <a href="/docs/2021fa/lecture9#root">above</a> and the <code>heroku-postbuild</code> script will build both workspaces to prep them for push to remote server. (We discussed <code>yarn workspaces run build</code> <a href="/docs/2021fa/lecture9#profit">above</a>) <code>heroku-postbuild</code> is a special command recognized by Heroku to allow you to customize the build process.</p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">/package.json</div><div class="codeBlockContent_csEI json"><pre tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;name&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;products-app&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;version&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;1.0.0&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;private&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;scripts&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;heroku-postbuild&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;yarn workspaces run build&quot;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;workspaces&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">[</span><span class="token string" style="color:rgb(80, 161, 79)">&quot;backend&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;frontend&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">]</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;license&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;MIT&quot;</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;devDependencies&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;heroku&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;^7.59.1&quot;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token punctuation" style="color:rgb(56, 58, 66)">,</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;resolutions&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(56, 58, 66)">{</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">    </span><span class="token property" style="color:rgb(152, 104, 1)">&quot;@oclif/color&quot;</span><span class="token operator" style="color:rgb(56, 58, 66)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;0.1.0&quot;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>The root <code>package.json</code> can have dependencies and yarn will install them with <code>yarn install</code> just like everything else. You will just need to run <code>yarn add -D -W &lt;pkg_name&gt;</code> since just using <code>yarn add</code> will show a warning message asking if you are sure about adding a dependency to the root. We add Heroku in this case to help with deployment!</p></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Normally, we don&#x27;t need the resolution section, but the Heroku CLI is bugged at the time of writing, so we have to add this to our root package.json and then yarn install again as a workaround.</p></div></div><p>Read more about <code>heroku-postbuild</code> <a href="https://devcenter.heroku.com/articles/nodejs-support#customizing-the-build-process" target="_blank" rel="noopener noreferrer">here</a>.</p><h5 class="anchor anchorWithStickyNavbar_y2LR" id="procfile"><code>Procfile</code><a aria-hidden="true" class="hash-link" href="#procfile" title="Direct link to heading">​</a></h5><p>We will also have Procfile that tells Heroku what script to run to start the application. In this case we will be using the backend <code>node index.js</code> to start the backend listening for requests and serving the frontend assets from the <code>frontend/build</code> folder.</p><div class="codeBlockContainer_J+bg"><div style="background-color:#fafafa" class="codeBlockTitle_oQzk">Procfile</div><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token plain">web: </span><span class="token function" style="color:rgb(64, 120, 242)">yarn</span><span class="token plain"> workspace backend start</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Read more about the Heroku Procfile <a href="https://devcenter.heroku.com/articles/procfile" target="_blank" rel="noopener noreferrer">here</a>.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="deploy-time">Deploy time<a aria-hidden="true" class="hash-link" href="#deploy-time" title="Direct link to heading">​</a></h4><p>We will now show the series of commands to deploy to Heroku. We will be using Heroku Git to deploy.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="background-color:#fafafa"><code class="codeBlockLines_1zSZ"><span class="token-line"><span class="token function" style="color:rgb(64, 120, 242)">yarn</span><span class="token plain"> </span><span class="token function" style="color:rgb(64, 120, 242)">add</span><span class="token plain"> -D -W heroku</span><br></span><span class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(64, 120, 242)">git</span><span class="token plain"> init</span><br></span><span class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(64, 120, 242)">git</span><span class="token plain"> </span><span class="token function" style="color:rgb(64, 120, 242)">add</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(193, 132, 1)">.</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(64, 120, 242)">git</span><span class="token plain"> commit -m </span><span class="token string" style="color:rgb(80, 161, 79)">&quot;COMMIT MESSAGE&quot;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(64, 120, 242)">yarn</span><span class="token plain"> heroku login</span><br></span><span class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(64, 120, 242)">yarn</span><span class="token plain"> heroku create </span><span class="token operator" style="color:rgb(56, 58, 66)">&lt;</span><span class="token plain">optional project name</span><span class="token operator" style="color:rgb(56, 58, 66)">&gt;</span><span class="token plain"></span><br></span><span class="token-line"><span class="token plain"></span><span class="token function" style="color:rgb(64, 120, 242)">git</span><span class="token plain"> push heroku master</span><br></span><span class="token-line"><span class="token plain"></span><span class="token punctuation" style="color:rgb(56, 58, 66)">(</span><span class="token plain">optional</span><span class="token punctuation" style="color:rgb(56, 58, 66)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(64, 120, 242)">yarn</span><span class="token plain"> heroku </span><span class="token function" style="color:rgb(64, 120, 242)">open</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>If you run into any bugs when running the code above (probably <code>yarn heroku create &lt;optional project name&gt;</code>), you can create a new project through Heroku&#x27;s website <a href="https://www.heroku.com" target="_blank" rel="noopener noreferrer">www.heroku.com</a></p></div></div><p>Visiting the URL should take you to the same application you had locally. Now you can share that link with your friends so they can visit your website too!</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>If you run into issues that the app isn&#x27;t authorized to use authentication, go to your Firebase project on <a href="https://firebase.google.com/" target="_blank" rel="noopener noreferrer">firebase.google.com</a> &gt; Go to Console &gt; <!-- -->[your project]<!-- --> &gt; Authentication <!-- -->[on sidebar]<!-- --> &gt; Sign-in Method &gt; Authorized domains &gt; Add Domain and enter the URL of your deployed site.</p></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>In your final submission of your final project, we want you to follow these steps to deploy your app to Heroku and place the link in the <code>README.md</code>. If you prefer to deploy on another platform feel free but we do not guarantee we know how to debug any issues that come up.</p></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/2021fa/lecture8"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« <!-- -->Lecture 8</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/2021fa/lecture10"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Lecture 10<!-- --> »</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#yarn-workspaces" class="table-of-contents__link toc-highlight">Yarn Workspaces</a><ul><li><a href="#replacing-our-familiar-workflow" class="table-of-contents__link toc-highlight">Replacing our familiar workflow</a></li><li><a href="#hoisting-package-manager-out-to-root" class="table-of-contents__link toc-highlight">Hoisting package manager out to root</a></li><li><a href="#local-workspace-as-dependency" class="table-of-contents__link toc-highlight">Local workspace as dependency</a></li><li><a href="#why-use-workspaces" class="table-of-contents__link toc-highlight">Why use workspaces?</a></li><li><a href="#yarn-workspaces-setup" class="table-of-contents__link toc-highlight">Yarn workspaces setup</a></li><li><a href="#yarn-workspaces-setup-1" class="table-of-contents__link toc-highlight">Yarn workspaces setup</a></li><li><a href="#learn-more" class="table-of-contents__link toc-highlight">Learn more!</a></li></ul></li><li><a href="#authentication" class="table-of-contents__link toc-highlight">Authentication</a></li><li><a href="#security" class="table-of-contents__link toc-highlight">Security</a><ul><li><a href="#1-passwords" class="table-of-contents__link toc-highlight">1. Passwords</a></li><li><a href="#2-input-sanitization" class="table-of-contents__link toc-highlight">2. Input Sanitization</a></li><li><a href="#3-dont-rely-on-client-side-verification" class="table-of-contents__link toc-highlight">3. Don&#39;t Rely on Client Side Verification</a></li><li><a href="#4-separation-of-privileges" class="table-of-contents__link toc-highlight">4. Separation of Privileges</a></li><li><a href="#lets-hack-our-app" class="table-of-contents__link toc-highlight">Let&#39;s hack our app!</a></li></ul></li><li><a href="#deployment" class="table-of-contents__link toc-highlight">Deployment</a><ul><li><a href="#deployment-setup" class="table-of-contents__link toc-highlight">Deployment Setup</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Course</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/introduction">Introduction</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/setup-environment">Setup Environment</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/setup-editor">Setup Editor</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/lecture1">First Lecture</a></li></ul></div><div class="col footer__col"><div class="footer__title">Cornell DTI</div><ul class="footer__items"><li class="footer__item"><a href="https://www.cornelldti.org" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/cornell-dti" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.facebook.com/cornelldti/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Facebook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://medium.com/cornell-design-tech-initiative/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Medium<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Cornell DTI Products</div><ul class="footer__items"><li class="footer__item"><a href="https://courseplan.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Course Plan<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.cureviews.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>CU Reviews<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://queueme.in/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Queue Me In<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.cudesign.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Design @ Cornell<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://zing-lsc-prod.web.app/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Zing<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/dti-text-logo.png" alt="Cornell DTI Text Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/dti-text-logo.png" alt="Cornell DTI Text Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></div><div class="footer__copyright">Copyright © 2021 Cornell Design & Tech Initiative. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c7857b94.js"></script>
<script src="/assets/js/main.8f5748b9.js"></script>
</body>
</html>