(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{161:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return r})),t.d(n,"rightToc",(function(){return i})),t.d(n,"default",(function(){return c}));t(58),t(31),t(22),t(23),t(59),t(0);var s=t(173);function a(){return(a=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e}).apply(this,arguments)}var r={id:"lecture9",title:"Lecture 9 - Design Patterns"},i=[{value:"Component Communication",id:"component-communication",children:[{value:"Bad Example 1: All-in-one",id:"bad-example-1-all-in-one",children:[]},{value:"Bad Example 2: Using Ref",id:"bad-example-2-using-ref",children:[]},{value:"Good Example: Lifting State Up",id:"good-example-lifting-state-up",children:[]}]},{value:"Composition",id:"composition",children:[{value:"Syntactic Sugar for props.children",id:"syntactic-sugar-for-propschildren",children:[]}]},{value:"Favor Composition Over Inheritance",id:"favor-composition-over-inheritance",children:[{value:"Bad Example: Using Inheritance",id:"bad-example-using-inheritance",children:[]},{value:"Good Example: Using Composition",id:"good-example-using-composition",children:[]}]},{value:"Different Dev & Production Env",id:"different-dev--production-env",children:[]},{value:"Using Routes",id:"using-routes",children:[]},{value:"Anti-patterns",id:"anti-patterns",children:[]}],o={rightToc:i},d="wrapper";function c(e){var n=e.components,t=function(e,n){if(null==e)return{};var t,s,a={},r=Object.keys(e);for(s=0;s<r.length;s++)t=r[s],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,["components"]);return Object(s.b)(d,a({},o,t,{components:n,mdxType:"MDXLayout"}),Object(s.b)("h2",{id:"component-communication"},"Component Communication"),Object(s.b)("h3",{id:"bad-example-1-all-in-one"},"Bad Example 1: All-in-one"),Object(s.b)("pre",null,Object(s.b)("code",a({parentName:"pre"},{className:"language-jsx"}),"import React, { Component } from 'react';\n\nexport default class BadMessageComponent extends Component {\n  state = { messages: [], newMessage: '' };\n\n  onNewMessageChange = e =>\n    this.setState({ newMessage: e.currentTarget.value });\n\n  onSubmitNew = () =>\n    this.setState(({ messages, newMessage }) => ({\n      messages: [...messages, newMessage],\n      newMessage: ''\n    }));\n\n  render() {\n    return (\n      <div>\n        <h3>Bad Message Component 1</h3>\n        <div>\n          {this.state.messages.map(msg => (\n            <div>{msg}</div>\n          ))}\n        </div>\n        <div>\n          <h4>Adder</h4>\n          <div>\n            <input\n              value={this.state.newMessage}\n              onChange={this.onNewMessageChange}\n            />\n            <button onClick={this.onSubmitNew}>Submit</button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n")),Object(s.b)("h3",{id:"bad-example-2-using-ref"},"Bad Example 2: Using Ref"),Object(s.b)("pre",null,Object(s.b)("code",a({parentName:"pre"},{className:"language-jsx"}),"import React, { Component } from 'react';\n\nclass List extends Component {\n  state = { messageList: [] };\n  addMessage = msg =>\n    this.setState(({ messageList }) => ({\n      messageList: [...messageList, msg]\n    }));\n  render() {\n    return (\n      <div>\n        {this.state.messageList.map(msg => (\n          <div>{msg}</div>\n        ))}\n      </div>\n    );\n  }\n}\n\nclass Adder extends Component {\n  state = { newMessage: '' };\n  onNewMessageChange = e =>\n    this.setState({ newMessage: e.currentTarget.value });\n  onSubmitNew = () => {\n    this.props.listRef.current.addMessage(this.state.newMessage);\n    this.setState({ newMessage: '' });\n  };\n  render() {\n    return (\n      <div>\n        <h4>Adder</h4>\n        <div>\n          <input\n            value={this.state.newMessage}\n            onChange={this.onNewMessageChange}\n          />\n          <button onClick={this.onSubmitNew}>Submit</button>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default class BadMessageComponent2 extends Component {\n  listRef = React.createRef();\n  render() {\n    return (\n      <div>\n        <h3>Bad Message Component 2</h3>\n        <List ref={this.listRef} />\n        <Adder listRef={this.listRef} />\n      </div>\n    );\n  }\n}\n")),Object(s.b)("h3",{id:"good-example-lifting-state-up"},"Good Example: Lifting State Up"),Object(s.b)("pre",null,Object(s.b)("code",a({parentName:"pre"},{className:"language-jsx"}),"import React, { Component } from 'react';\n\nconst List = ({ messages }) => (\n  <div>\n    {messages.map(msg => (\n      <div>{msg}</div>\n    ))}\n  </div>\n);\n\nexport class MessageAdder extends Component {\n  state = { newMessage: '' };\n\n  onNewMessageChange = e =>\n    this.setState({ newMessage: e.currentTarget.value });\n  buttonOnClick = () => {\n    this.props.onAdd(this.state.newMessage);\n    this.setState({ newMessage: '' });\n  };\n\n  render() {\n    return (\n      <div>\n        <h4>Adder</h4>\n        <div>\n          <input\n            value={this.state.newMessage}\n            onChange={this.onNewMessageChange}\n          />\n          <button onClick={this.buttonOnClick}>Submit</button>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default class LiftingStateUp extends Component {\n  state = { messages: [] };\n\n  onAdd = msg =>\n    this.setState(({ messages }) => ({ messages: [...messages, msg] }));\n\n  render() {\n    return (\n      <div>\n        <h3>Lifting State Up</h3>\n        <List messages={this.state.messages} />\n        <MessageAdder onAdd={this.onAdd} />\n      </div>\n    );\n  }\n}\n")),Object(s.b)("h2",{id:"composition"},"Composition"),Object(s.b)("h3",{id:"syntactic-sugar-for-propschildren"},"Syntactic Sugar for ",Object(s.b)("inlineCode",{parentName:"h3"},"props.children")),Object(s.b)("p",null,"React Documentation is ",Object(s.b)("a",a({parentName:"p"},{href:"https://reactjs.org/docs/composition-vs-inheritance.html#containment"}),"here")),Object(s.b)("pre",null,Object(s.b)("code",a({parentName:"pre"},{className:"language-jsx"}),"function RedBackgroundContainer(props) {\n  return (\n    <div style={{ background: \u2018red\u2019 }}>\n      <div>Hello</div>\n      {props.children}\n    </div>\n  );\n}\n\n// somewhere else\n<RedBackgroundContainer>\n  <div>Stuff inside the container</div>\n</RedBackgroundContainer>\n")),Object(s.b)("h2",{id:"favor-composition-over-inheritance"},"Favor Composition Over Inheritance"),Object(s.b)("h3",{id:"bad-example-using-inheritance"},"Bad Example: Using Inheritance"),Object(s.b)("pre",null,Object(s.b)("code",a({parentName:"pre"},{className:"language-jsx"}),"class TextEditor extends Component { ... }\n\nclass MarkdownTextEditor extends TextEditor {\n  render() {\n    // ??? what should we do?\n    // call super.render()?\n  }\n}\n")),Object(s.b)("h3",{id:"good-example-using-composition"},"Good Example: Using Composition"),Object(s.b)("pre",null,Object(s.b)("code",a({parentName:"pre"},{className:"language-jsx"}),"class MarkdownTextEditor extends Component {\n  // some additional helper methods\n\n  render() {\n    return (\n      <div>\n        {/* some of the customization code */}\n        <TextEditor onEdit={...} />\n      </div>\n    );\n  }\n}\n")),Object(s.b)("h2",{id:"different-dev--production-env"},"Different Dev & Production Env"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"Create a different ",Object(s.b)("inlineCode",{parentName:"li"},".env")," file for dev and production environment."),Object(s.b)("li",{parentName:"ul"},"Load different ",Object(s.b)("inlineCode",{parentName:"li"},".env")," file for different environment."),Object(s.b)("li",{parentName:"ul"},"Add those ",Object(s.b)("inlineCode",{parentName:"li"},".env")," files to ",Object(s.b)("inlineCode",{parentName:"li"},".gitignore"),": For security reasons.")),Object(s.b)("pre",null,Object(s.b)("code",a({parentName:"pre"},{className:"language-bash"}),"# .env.dev file\nDB_SECRET=DEV\n\n# .env.production file\nDB_SECRET=PRODUCTION\n")),Object(s.b)("h2",{id:"using-routes"},"Using Routes"),Object(s.b)("pre",null,Object(s.b)("code",a({parentName:"pre"},{className:"language-javascript"}),"// index.js\nconst express = require('express');\nconst gameRouter = require('./game');\nconst messageBoardRouter = require('./message-board');\n\nconst isProduction = process.env.NODE_ENV === 'production';\nrequire('dotenv').config({\n  path: isProduction ? '.env.production' : '.env.dev'\n});\n\nconst app = express();\n\n// WARINING: usually you should never send these kind of information to the user\n// We do here to let you see that you are indeed using different config.\n// Again, the .env files are not gitignore here simply because we want you to see the difference.\napp.get('/', (_, resp) => resp.send(`DB_SECRET is ${process.env.DB_SECRET}\\n`));\n\napp.use('/game', gameRouter);\napp.use('/msg-board', messageBoardRouter);\n\napp.listen(8080, () => console.log('Server started.'));\n")),Object(s.b)("pre",null,Object(s.b)("code",a({parentName:"pre"},{className:"language-javascript"}),"// game.js\nconst express = require('express');\n\nconst router = express.Router();\n\nrouter.get('/guess-number', (req, resp) => {\n  if (parseInt(req.query.num) === 42) {\n    resp.send('Your guess is right.');\n  } else {\n    resp.send('Your guess is wrong.');\n  }\n});\n\n// imaging there are a lot of other games...\n\nmodule.exports = router;\n")),Object(s.b)("pre",null,Object(s.b)("code",a({parentName:"pre"},{className:"language-javascript"}),"// message-board.js\nconst express = require('express');\n\nconst router = express.Router();\n\nrouter.get('/', (_, resp) => resp.send([{ id: 1, content: 'hello world' }]));\n\n// imaging there are a lot of other functionality of message board.\n\nmodule.exports = router;\n")),Object(s.b)("h2",{id:"anti-patterns"},"Anti-patterns"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},"Spaghetti Code"),Object(s.b)("li",{parentName:"ul"},"Premature Optimizations"),Object(s.b)("li",{parentName:"ul"},"Magic Numbers"),Object(s.b)("li",{parentName:"ul"},"Overengineering: DO NOT let this lecture destroy your codebase")))}c.isMDXComponent=!0},173:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return p}));var s=t(0),a=t.n(s),r=a.a.createContext({}),i=function(e){var n=a.a.useContext(r),t=n;return e&&(t="function"==typeof e?e(n):Object.assign({},n,e)),t},o=function(e){var n=i(e.components);return a.a.createElement(r.Provider,{value:n},e.children)};var d="mdxType",c={inlineCode:"code",wrapper:function(e){var n=e.children;return a.a.createElement(a.a.Fragment,{},n)}},l=Object(s.forwardRef)((function(e,n){var t=e.components,s=e.mdxType,r=e.originalType,o=e.parentName,d=function(e,n){var t={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&-1===n.indexOf(s)&&(t[s]=e[s]);return t}(e,["components","mdxType","originalType","parentName"]),l=i(t),p=s,u=l[o+"."+p]||l[p]||c[p]||r;return t?a.a.createElement(u,Object.assign({},{ref:n},d,{components:t})):a.a.createElement(u,Object.assign({},{ref:n},d))}));function p(e,n){var t=arguments,s=n&&n.mdxType;if("string"==typeof e||s){var r=t.length,i=new Array(r);i[0]=l;var o={};for(var c in n)hasOwnProperty.call(n,c)&&(o[c]=n[c]);o.originalType=e,o[d]="string"==typeof e?e:s,i[1]=o;for(var p=2;p<r;p++)i[p]=t[p];return a.a.createElement.apply(null,i)}return a.a.createElement.apply(null,t)}l.displayName="MDXCreateElement"}}]);